<% content_for(:title, "Profile") %>
<div class="mt-10 sm:mt-5">
  <div class="md:grid md:grid-cols-3 md:gap-6">
    <div class="md:col-span-1">
      <div class="px-4 sm:px-0">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Personal Information</h3>
      </div>
    </div>
    <div class="mt-5 md:mt-0 md:col-span-2">
      <div class="shadow overflow-hidden sm:rounded-md">
        <div class="px-4 py-5 bg-white sm:p-6">
          <%= form_with(model: @user) do |form| %>
            <div class="grid grid-cols-6 gap-6">
              <div class="col-span-6 sm:col-span-4">
                <%= form.label :name, class: "block text-sm font-medium text-gray-700" %>
                <%= form.text_field :name, class: "mt-1 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md" %>
              </div>

              <div class="col-span-6 sm:col-span-4">
                <%= form.label :email, class: "block text-sm font-medium text-gray-700" %>
                <%= form.email_field :email, class: "mt-1 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md" %>
              </div>

              <div class="col-span-6">
                <label class="block text-sm font-medium text-gray-700"> Photo </label>
                <div class="mt-1 flex items-center">
                  <span class="inline-block h-12 w-12 rounded-full overflow-hidden bg-gray-100">
                    <%= image_tag(@user.gravatar_url) %>
                  </span>
                  <span class="ml-5">
                    <%= link_to 'Change at gravatar.com', 'https://en.gravatar.com/emails', class: "ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
                  </span>
                </div>
              </div>
            </div>
        </div>
        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <%= form.submit "Save", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="mt-10 sm:mt-5">
  <div class="md:grid md:grid-cols-3 md:gap-6">
    <div class="md:col-span-1">
      <div class="px-4 sm:px-0">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Organization Information</h3>
      </div>
    </div>
    <div class="mt-5 md:mt-0 md:col-span-2">
      <div class="shadow overflow-hidden sm:rounded-md">
        <div class="px-4 py-5 bg-white sm:p-6">
          <%= form_with(model: @user.organization, url: organization_path(@user.organization)) do |form| %>
            <div class="grid grid-cols-6 gap-6">
              <div class="col-span-6 sm:col-span-4">
                <%= form.label :name, "Organization name", class: "block text-sm font-medium text-gray-700" %>
                <% if can? :edit, @user.organization %>
                  <%= form.text_field :name, class: "mt-1 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md" %>
                <% else %>
                  <%= form.text_field :name, class: "mt-1 shadow-sm bg-gray-100 focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md", disabled: true %>
                <% end %>
              </div>
              <% if Flipper.enabled? :stripe %>
                <div class="col-span-6 sm:col-span-4">
                  <% if current_user.organization.payment_processor&.subscribed? %>
                    <%= link_to "Manage subscription", @portal_session.url, class: "text-indigo-500 hover:text-indigo-600 flex" %>
                  <% else %>
                    <%= link_to "Subscribe", plans_url, class: "text-indigo-500 hover:text-indigo-600 flex" %>
                  <% end %>
                </div>
              <% end %>
              <% if can? :invite, User %>
                <div class="col-span-6">
                  <%= link_to new_user_invitation_path, class: "text-indigo-500 hover:text-indigo-600 flex" do %>
                    Invite member
                    <span class="ml-3">
                      <%= show_svg('outline/user-add') %>
                    </span>
                  <% end %>
                </div>
              <% end %>
            </div>
        </div>
        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <% if can? :edit, @user.organization %>
            <%= form.submit "Save", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
            <% else %>
            <%= form.submit "Save", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-gray-500 bg-gray-300", disabled: true %>
            <% end %>
        <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="mt-10 sm:mt-5">
  <div class="md:grid md:grid-cols-3 md:gap-6">
    <div class="md:col-span-1">
      <div class="px-4 sm:px-0">
        <h3 class="text-lg font-medium leading-6 text-gray-900">Developer Settings</h3>
        <p class="mt-1 text-sm text-gray-600">Use your API key to access the RoQR API</p>
      </div>
    </div>
    <div class="mt-5 md:mt-0 md:col-span-2">
      <div class="shadow overflow-hidden sm:rounded-md">
        <div class="px-4 py-5 bg-white sm:p-6">
            <div class="grid grid-cols-2 gap-6">
              <div class="col-span-4">
                <label class="block text-sm font-medium text-gray-700"> API Key </label>
                <%= form_with model: current_user, url: user_private_api_keys_path do |f| %>
                  <div data-controller="clipboard" class="flex justify-center">
                    <%= f.text_field :private_api_key, "data-clipboard-target": "source", disabled: true, class: "mt-1 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md" %>
                    <a data-action="clipboard#copy" href="#" target="_blank" class="ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"><%= show_svg('outline/clipboard-copy') %></a>
                    <%= f.submit "Generate New Key", class: "ml-5 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"%>
                  </div>
                <% end %>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>
</div>
